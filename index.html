<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gestión de Clientes</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #050505;
      color: #fff;
    }
    header {
      background: linear-gradient(90deg, #7f00ff, #ff00aa);
      padding: 20px;
      text-align: center;
      box-shadow: 0 0 15px rgba(127, 0, 255, 0.5);
    }
    h1 {
      margin: 0;
      font-size: 1.8em;
    }
    .saldo {
      text-align: right;
      padding: 10px 20px;
      font-size: 1.2em;
      font-weight: bold;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { color: #ff00aa; text-shadow: 0 0 5px #ff00aa; }
      50% { color: #7f00ff; text-shadow: 0 0 15px #7f00ff; }
      100% { color: #ff00aa; text-shadow: 0 0 5px #ff00aa; }
    }
    .etiqueta-pagado {
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: bold;
      margin-left: 10px;
      animation: palpitar 2.5s infinite ease-in-out;
    }
    .pagado-incompleto {
      background-color: #ff0033;
      color: #fff;
    }
    .pagado-completo {
      background-color: #00cc66;
      color: #fff;
      animation: none;
    }
    @keyframes palpitar {
      0% { background-color: #ff0033; }
      50% { background-color: #990022; }
      100% { background-color: #ff0033; }
    }
    .etiqueta-socio {
      background-color: #ff0033;
      color: #fff;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: bold;
      margin-left: 10px;
      animation: palpitar-socio 2.5s infinite ease-in-out;
    }
    @keyframes palpitar-socio {
      0% { background-color: #ff0033; }
      50% { background-color: #990022; }
      100% { background-color: #ff0033; }
    }
    .etiqueta-independiente {
      background-color: #00c2ff;
      color: #000;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: bold;
      margin-left: 10px;
      animation: palpitar-indep 2.5s infinite ease-in-out;
    }
    @keyframes palpitar-indep {
      0% { background-color: #00c2ff; }
      50% { background-color: #0077aa; }
      100% { background-color: #00c2ff; }
    }
  </style>
</head>
<body>
  <header><h1>Gestión de Clientes</h1></header>
  <div class="saldo">Saldo total: $<span id="saldoTotal">0</span></div>
  <div class="container">
    <button class="add-btn" onclick="abrirFormularioCliente()">➕ Agregar Cliente</button>
    <table>
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Crédito Personal</th>
          <th>Vencimiento</th>
          <th>Teléfono</th>
        </tr>
      </thead>
      <tbody id="clientesTabla"></tbody>
    </table>
  </div>

  <!-- Formulario para agregar cliente -->
  <div class="modal" id="formularioCliente">
    <div class="modal-content">
      <button class="close-btn" onclick="cerrarFormularioCliente()">Cerrar</button>
      <h2>Agregar Cliente</h2>
      <input type="text" id="nombreInput" placeholder="Nombre y apellido" />
      <input type="text" id="dniInput" placeholder="DNI" />
      <input type="number" id="cuotasInput" placeholder="Cantidad de cuotas" />
      <input type="number" id="valorCuotaInput" placeholder="Valor de cada cuota" />
      <input type="text" id="equipoInput" placeholder="Equipo vendido" />

      <label>Vencimiento:</label>
      <div style="display:flex; gap:10px;">
        <select id="diaVencimiento">
          <option value="">Día</option>
          ${[...Array(31)].map((_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
        </select>
        <select id="mesVencimiento">
          <option value="">Mes</option>
          <option value="enero">Enero</option>
          <option value="febrero">Febrero</option>
          <option value="marzo">Marzo</option>
          <option value="abril">Abril</option>
          <option value="mayo">Mayo</option>
          <option value="junio">Junio</option>
          <option value="julio">Julio</option>
          <option value="agosto">Agosto</option>
          <option value="septiembre">Septiembre</option>
          <option value="octubre">Octubre</option>
          <option value="noviembre">Noviembre</option>
          <option value="diciembre">Diciembre</option>
        </select>
        <input type="number" id="anioVencimiento" placeholder="Año" min="2020" max="2035" />
      </div>

      <label>Socio:</label>
      <select id="socioSelect" onchange="mostrarCampoNuevoSocio()">
        <option value="Independiente">Independiente</option>
        <option value="Mario Castro">Mario Castro</option>
        <option value="Juan Pérez">Juan Pérez</option>
        <option value="nuevo">Agregar nuevo socio</option>
      </select>
      <input type="text" id="nuevoSocioInput" placeholder="Nombre del nuevo socio" style="display:none;" />

      <button class="save-mov-btn" onclick="guardarCliente()">Guardar Cliente</button>
    </div>
  </div>

  <!-- Modal para editar vencimiento -->
  <div class="modal" id="modalVencimiento">
    <div class="modal-content">
      <button class="close-btn" onclick="cerrarModalVencimiento()">Cerrar</button>
      <h3>Editar Vencimiento</h3>
      <div style="display:flex; gap:10px;">
        <select id="editDiaVencimiento">
          <option value="">Día</option>
          ${[...Array(31)].map((_, i) => `<option value="${i+1}">${i+1}</option>`).join('')}
        </select>
        <select id="editMesVencimiento">
          <option value="">Mes</option>
          <option value="enero">Enero</option>
          <option value="febrero">Febrero</option>
          <option value="marzo">Marzo</option>
          <option value="abril">Abril</option>
          <option value="mayo">Mayo</option>
          <option value="junio">Junio</option>
          <option value="julio">Julio</option>
          <option value="agosto">Agosto</option>
          <option value="septiembre">Septiembre</option>
          <option value="octubre">Octubre</option>
          <option value="noviembre">Noviembre</option>
          <option value="diciembre">Diciembre</option>
        </select>
        <input type="number" id="editAnioVencimiento" placeholder="Año" min="2020" max="2035" />
      </div>
      <button class="save-mov-btn" onclick="guardarVencimiento()">Guardar</button>
    </div>
  </div>
<script>
let clientes = [];
let clienteEditando = null;

function abrirFormularioCliente() {
  document.getElementById("formularioCliente").style.display = "block";
}

function cerrarFormularioCliente() {
  document.getElementById("formularioCliente").style.display = "none";
}

function mostrarCampoNuevoSocio() {
  const select = document.getElementById("socioSelect");
  const input = document.getElementById("nuevoSocioInput");
  input.style.display = select.value === "nuevo" ? "block" : "none";
}

function guardarCliente() {
  const nombre = document.getElementById("nombreInput").value;
  const dni = document.getElementById("dniInput").value;
  const cuotas = parseInt(document.getElementById("cuotasInput").value);
  const valorCuota = parseInt(document.getElementById("valorCuotaInput").value);
  const equipo = document.getElementById("equipoInput").value;

  const dia = document.getElementById("diaVencimiento").value;
  const mes = document.getElementById("mesVencimiento").value;
  const anio = document.getElementById("anioVencimiento").value;
  const vencimiento = `${dia} de ${mes} de ${anio}`;

  let socio = document.getElementById("socioSelect").value;
  if (socio === "nuevo") {
    socio = document.getElementById("nuevoSocioInput").value || "Independiente";
  }

  const cliente = {
    nombre,
    dni,
    cuotas,
    valorCuota,
    totalCredito: cuotas * valorCuota,
    equipo,
    vencimiento,
    socio,
    telefono: "",
    movimientos: []
  };

  clientes.push(cliente);
  cerrarFormularioCliente();
  actualizarTabla();
}

function actualizarTabla() {
  const tabla = document.getElementById("clientesTabla");
  tabla.innerHTML = "";
  let saldoTotal = 0;

  clientes.forEach((cliente, index) => {
    const totalPagado = cliente.movimientos.reduce((acc, m) => acc + m.pago, 0);
    const pagadoClass = totalPagado >= cliente.totalCredito ? "pagado-completo" : "pagado-incompleto";

    const fila = document.createElement("tr");
    fila.innerHTML = `
      <td>${cliente.nombre} <span style="cursor:pointer;" onclick="verDatosCliente(${index})">⚙️</span></td>
      <td>${cliente.cuotas} de $${cliente.valorCuota.toLocaleString()} → Total: $${cliente.totalCredito.toLocaleString()}
        <span class="etiqueta-pagado ${pagadoClass}">Pagado: $${totalPagado.toLocaleString()}</span>
      </td>
      <td>${cliente.vencimiento} <span style="cursor:pointer;" onclick="editarVencimiento(${index})">✏️</span></td>
      <td>${cliente.telefono || '<span style="cursor:pointer;" onclick="editarTelefono('+index+')">✏️</span>'}</td>
    `;
    tabla.appendChild(fila);
    saldoTotal += totalPagado;
  });

  document.getElementById("saldoTotal").textContent = saldoTotal.toLocaleString();
}

function verDatosCliente(index) {
  const cliente = clientes[index];
  const modal = document.createElement("div");
  modal.className = "modal";
  modal.innerHTML = `
    <div class="modal-content">
      <button class="close-btn" onclick="this.parentElement.parentElement.remove()">Cerrar</button>
      <h3>${cliente.nombre}</h3>
      <p><strong>DNI:</strong> ${cliente.dni}</p>
      <p><strong>Equipo:</strong> ${cliente.equipo}
        ${cliente.socio === "Independiente"
          ? '<span class="etiqueta-independiente">Independiente</span>'
          : '<span class="etiqueta-socio">Socio: ' + cliente.socio + '</span>'}
        <span style="cursor:pointer;" onclick="editarSocio(${index})">✏️</span>
      </p>
      <p><strong>Vencimiento:</strong> ${cliente.vencimiento}</p>
      <p><strong>Teléfono:</strong> ${cliente.telefono || 'No registrado'}</p>
    </div>
  `;
  document.body.appendChild(modal);
}

function editarTelefono(index) {
  const nuevoTel = prompt("Ingresá el número de teléfono:");
  if (nuevoTel) {
    clientes[index].telefono = nuevoTel;
    actualizarTabla();
  }
}

function editarVencimiento(index) {
  clienteEditando = index;
  document.getElementById("modalVencimiento").style.display = "block";
}

function cerrarModalVencimiento() {
  document.getElementById("modalVencimiento").style.display = "none";
}

function guardarVencimiento() {
  const dia = document.getElementById("editDiaVencimiento").value;
  const mes = document.getElementById("editMesVencimiento").value;
  const anio = document.getElementById("editAnioVencimiento").value;
  const nuevaFecha = `${dia} de ${mes} de ${anio}`;
  clientes[clienteEditando].vencimiento = nuevaFecha;
  cerrarModalVencimiento();
  actualizarTabla();
}

function editarSocio(index) {
  const nuevoSocio = prompt("Ingresá el nombre del socio o escribí 'Independiente':");
  if (nuevoSocio) {
    clientes[index].socio = nuevoSocio;
    actualizarTabla();
  }
}
</script>
</body>
</html>
